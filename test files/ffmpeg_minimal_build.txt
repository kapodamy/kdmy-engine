./configure --disable-everything --disable-network --disable-autodetect --enable-decoder=aac*,ac3*,opus,vorbis,h264,vp8,vp9,mp3* --enable-demuxer=mov,m4v,matroska,avi --enable-bsf=eac3_core,h264_metadata,h264_mp4toannexb,h264_redundant_pps,mpeg4_unpack_bframes,opus_metadata,vp9_metadata,vp9_raw_reorder,vp9_superframe,vp9_superframe_split --enable-protocol=file --enable-shared --disable-debug  --disable-avdevice --disable-postproc --disable-avfilter --disable-pthreads
make

optional:
--enable-hardcoded-tables				increase dll size of libavcodec ~15%
--enable-small						create smaller dlls, but decreases decoding performance

if links to MINGW64 dlls:
--extra-cflags="-static-libgcc -static-libstdc++ -Wl,-Bstatic -lstdc++ -lpthread -Wl,-Bdynamic"
--extra-ldflags=="-static-libgcc -static-libstdc++ -Wl,-Bstatic,--whole-archive -lpthread -Wl,-Bdynamic -Wl,--no-whole-archive"

or download the shared libraries from https://www.gyan.dev/ffmpeg/builds/ or https://github.com/BtbN/FFmpeg-Build and replace avutil-NN.dll
